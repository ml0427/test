<!DOCTYPE html>
<html>
<head>
<meta charset="BIG5">
<title>Insert title here</title>
</head>
<body>
	<script type="text/javascript">
		function doGet(e) {

			var params = e.parameter;
			// 可以針對你帶入的資料變化  params.xxxxxx      xxxxx = 你帶進來的key值  
			var name = params.name;
			var phone = params.phone;
			var time = params.time;
			var price = params.price;
			var order = params.order;

			//將Sheet指定為"資料庫"試算表   SpreadSheet = 試算表 ，貼上excel那段參數
			var SpreadSheet = SpreadsheetApp.openById("1MySGNMPkZHBUUYSB6naqbT0ULPujfzRbLHJEuM1f0Ss");
			//取得頁籤:"工作表1"              
			//Sheet = 頁籤
			var Sheet = SpreadSheet.getSheets()[0];
			//取得有資料的最後一行的"行數"(目的要在最後一行插入新資料)
			var LastRow = Sheet.getLastRow();

			// This represents ALL the data
			var range = Sheet.getRange(LastRow, 6);

			// 訂單編號往後+1 
			var orderNum = parseFloat(range.getValues()) + 1;
			//第一筆訂單 需要轉為1
			if (LastRow == 1) {
				orderNum = 1;
			}

			//--開始寫入資料--  擋住沒填時間 不給寫入資料，防止被亂撞api
			if (time !== undefined) {
				//在最後一行的下一行寫入資料
				Sheet.getRange(LastRow + 1, 1).setValue(name);
				Sheet.getRange(LastRow + 1, 2).setValue(phone);
				Sheet.getRange(LastRow + 1, 3).setValue(time);
				Sheet.getRange(LastRow + 1, 4).setValue(order);
				Sheet.getRange(LastRow + 1, 5).setValue(price);
				Sheet.getRange(LastRow + 1, 6).setValue(orderNum);
				return ContentService.createTextOutput(true);
			}

			// 被亂撞 會回吐這段文字給前端
			return ContentService.createTextOutput('別亂撞我ㄚㄚㄚ :)');
		}
	</script>
</body>
</html>